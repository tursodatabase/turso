@database :default:
@database :default-no-rowidalias:

test select-offset-0 {
    SELECT id FROM users ORDER BY id LIMIT 1 OFFSET 0;
}
expect {
    1
}

test select-offset-1 {
    SELECT id FROM users ORDER BY id LIMIT 1 OFFSET 1;
}
expect {
    2
}

test select-offset-negative {
    SELECT id FROM users ORDER BY id LIMIT 1 OFFSET -1;
}
expect {
    1
}

test select-offset-0-groupby {
    SELECT COUNT(*) FROM users GROUP BY STATE ORDER BY STATE LIMIT 5 OFFSET 0;
}
expect {
    207
    206
    224
    194
    196
}

test select-offset-1-groupby {
    SELECT COUNT(*) FROM users GROUP BY STATE ORDER BY STATE LIMIT 5 OFFSET 1;
}
expect {
    206
    224
    194
    196
    231
}

test select-offset-subquery {
    SELECT id, first_name, age
    FROM (
    SELECT id, first_name, age
    FROM users
    ORDER BY id ASC
    LIMIT 5 OFFSET 2
    )
    ORDER BY id DESC;
}
expect {
    7|Lilly|33
    6|Roscoe|27
    5|Nikko|39
    4|Krystel|88
    3|Edmond|83
}

