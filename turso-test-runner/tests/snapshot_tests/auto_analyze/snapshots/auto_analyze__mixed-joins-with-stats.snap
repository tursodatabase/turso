---
source: auto_analyze.sqltest
expression: |-
  SELECT c.name, o.id, p.name
      FROM customers c
      LEFT JOIN orders o ON o.customer_id = c.id
      JOIN products p ON p.id = o.product_id
      WHERE c.region = 'North';
info:
  statement_type: SELECT
  tables:
  - customers
  - o.customer_id
  - orders
  - p.id
  - products
  setup_blocks:
  - schema
  - data
  - auto_analyze_warmup
  database: ':memory:'
---
QUERY PLAN
|--SCAN customers AS c
|--SEARCH o USING INDEX idx_orders_customer
`--SEARCH p USING INDEX ephemeral_products_t3

BYTECODE
addr  opcode              p1  p2  p3  p4              p5  comment
   0  Init                 0  40   0                   0  Start at 40
   1  OpenRead             0   2   0  k(4,B,B,B,B)     0  table=customers, root=2, iDb=0
   2  OpenRead             1   4   0  k(5,B,B,B,B,B)   0  table=orders, root=4, iDb=0
   3  OpenRead             2   6   0  k(2,B)           0  index=idx_orders_customer, root=6, iDb=0
   4  OpenRead             3   3   0  k(4,B,B,B,B)     0  table=products, root=3, iDb=0
   5  Rewind               0  39   0                   0  Rewind table customers
   6    Column             0   2   5                   0  r[5]=customers.region
   7    Ne                 5   6  38  Binary           0  if r[5]!=r[6] goto 38
   8    RowId              0   7   0                   0  r[7]=customers.rowid
   9    SeekGE             2  38   7                   0  key=[7..7]
  10      IdxGT            2  38   7                   0  key=[7..7]
  11      DeferredSeek     2   1   0                   0
  12      Once            22   0   0                   0  goto 22
  13      OpenAutoindex    4   0   0                   0  cursor=4
  14      Rewind           3  15   0                   0  Rewind table products
  15        RowId          3   8   0                   0  r[8]=products.rowid
  16        Column         3   1   9                   0  r[9]=products.name
  17        RowId          3  10   0                   0  r[10]=products.rowid
  18        MakeRecord     8   3  11                   0  r[11]=mkrec(r[8..10]); for ephemeral_products_t3
  19        FilterAdd      4   8   1                   0  bloom_filter_add(r[8..9])
  20        IdxInsert      4  11   8                   0  key=r[11]
  21      Next             3  15   0                   0
  22      Column           1   2  12                   0  r[12]=orders.product_id
  23      IsNull          12  37   0                   0  if (r[12]==NULL) goto 37
  24      Affinity        12   1   0                   0  r[12..13] = C
  25      Filter           4  37  12                   1  if !bloom_filter(r[12..13]) goto 37
  26      SeekGE           4  37  12                   0  key=[12..12]
  27        IdxGT          4  37  12                   0  key=[12..12]
  28        DeferredSeek   4   3   0                   0
  29        IdxRowId       4  14   0                   0  r[14]=cursor 4 for index ephemeral_products_t3.rowid
  30        Column         1   2  15                   0  r[15]=orders.product_id
  31        Ne            14  15  36  Binary           0  if r[14]!=r[15] goto 36
  32        Column         0   1   1                   0  r[1]=customers.name
  33        IdxRowId       2   2   0                   0  r[2]=cursor 2 for index idx_orders_customer.rowid
  34        Column         4   1   3                   0  r[3]=ephemeral_products_t3.name
  35        ResultRow      1   3   0                   0  output=r[1..3]
  36      Next             4  27   0                   0
  37    Next               2  10   0                   0
  38  Next                 0   6   0                   0
  39  Halt                 0   0   0                   0
  40  Transaction          0   1  13                   0  iDb=0 tx_mode=Read
  41  String8              0   6   0  North            0  r[6]='North'
  42  Goto                 0   1   0                   0
