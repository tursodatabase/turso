---
source: snapshot_plans.sqltest
expression: PRAGMA integrity_check;
info:
  statement_type: OTHER
  setup_blocks:
  - schema
  database: ':memory:'
---
QUERY PLAN


BYTECODE
addr  opcode        p1   p2   p3  p4                                   p5  comment
   0  Init           0  160    0                                        0  Start at 160
   1  Integer       99    2    0                                        0  r[2]=99
   2  Integer        0    3    0                                        0  r[3]=0
   3  IntegrityCk  100    0    0                                        0  roots=[2, 5, 4, 3, 1] message_register=4
   4  IsNull         4   11    0                                        0  if (r[4]==NULL) goto 11
   5  String8        0    5    0  *** in database main ***
             0  r[5]='*** in database main ***
'
   6  Concat         4    5    4                                        0  r[4]=r[5] + r[4]
   7  Integer        1    3    0                                        0  r[3]=1
   8  ResultRow      4    1    0                                        0  output=r[4]
   9  IfPos          2   11    1                                        0  r[2]>0 -> r[2]-=1, goto 11
  10  Halt           0    0    0                                        0
  11  OpenRead       0    2    0  k(4,B,B,B,B)                          0  table=t, root=2, iDb=0
  12  OpenRead       1    5    0  k(2,B)                                0  =idx_t_expr_partial, root=5, iDb=0
  13  Integer        0    6    0                                        0  r[6]=0
  14  OpenRead       2    4    0  k(2,B)                                0  =idx_t_c, root=4, iDb=0
  15  Integer        0    7    0                                        0  r[7]=0
  16  OpenRead       3    3    0  k(2,B)                                0  =idx_t_b, root=3, iDb=0
  17  Integer        0    8    0                                        0  r[8]=0
  18  Integer        0    9    0                                        0  r[9]=0
  19  Rewind         0  132    0                                        0  Rewind table t
  20    AddImm       9    1    0                                        0  r[9]=r[9]+1
  21    Column       0    1   10                                        0  r[10]=t.b
  22    NotNull     10   28    0                                        0  r[10]!=NULL -> goto 28
  23    String8      0    4    0  NULL value in t.b                     0  r[4]='NULL value in t.b'
  24    Integer      1    3    0                                        0  r[3]=1
  25    ResultRow    4    1    0                                        0  output=r[4]
  26    IfPos        2   28    1                                        0  r[2]>0 -> r[2]-=1, goto 28
  27    Halt         0    0    0                                        0
  28    Column       0    2   12                                        0  r[12]=t.c
  29    Gt          12   13   35  Binary                                0  if r[12]>r[13] goto 35
  30    String8      0    4    0  CHECK constraint failed in t          0  r[4]='CHECK constraint failed in t'
  31    Integer      1    3    0                                        0  r[3]=1
  32    ResultRow    4    1    0                                        0  output=r[4]
  33    IfPos        2   35    1                                        0  r[2]>0 -> r[2]-=1, goto 35
  34    Halt         0    0    0                                        0
  35    Column       0    3   14                                        0  r[14]=t.d
  36    IsNull      14   66    0                                        0  if (r[14]==NULL) goto 66
  37    AddImm       6    1    0                                        0  r[6]=r[6]+1
  38    Column       0    3   17                                        0  r[17]=t.d
  39    Function     0   17   15  lower                                 0  r[15]=func(r[17])
  40    RowId        0   16    0                                        0  r[16]=t.rowid
  41    Affinity    15    1    0                                        0  r[15..16] = A
  42    Found        1   54   15                                        0  if found goto 54
  43    String8      0    4    0  row                                   0  r[4]='row '
  44    Concat       9    4    4                                        0  r[4]=r[4] + r[9]
  45    String8      0    5    0   missing from index                   0  r[5]=' missing from index '
  46    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  47    String8      0    5    0  idx_t_expr_partial                    0  r[5]='idx_t_expr_partial'
  48    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  49    Integer      1    3    0                                        0  r[3]=1
  50    ResultRow    4    1    0                                        0  output=r[4]
  51    IfPos        2   53    1                                        0  r[2]>0 -> r[2]-=1, goto 53
  52    Halt         0    0    0                                        0
  53    Goto         0   66    0                                        0
  54    IdxRowId     1   18    0                                        0  r[18]=cursor 1.rowid
  55    Eq          18   16   66                                        0  if r[18]==r[16] goto 66
  56    String8      0    4    0  rowid not at end-of-record for row    0  r[4]='rowid not at end-of-record for row '
  57    Concat       9    4    4                                        0  r[4]=r[4] + r[9]
  58    String8      0    5    0   of index                             0  r[5]=' of index '
  59    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  60    String8      0    5    0  idx_t_expr_partial                    0  r[5]='idx_t_expr_partial'
  61    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  62    Integer      1    3    0                                        0  r[3]=1
  63    ResultRow    4    1    0                                        0  output=r[4]
  64    IfPos        2   66    1                                        0  r[2]>0 -> r[2]-=1, goto 66
  65    Halt         0    0    0                                        0
  66    AddImm       7    1    0                                        0  r[7]=r[7]+1
  67    Column       0    2   19                                        0  r[19]=t.c
  68    RowId        0   20    0                                        0  r[20]=t.rowid
  69    Affinity    19    1    0                                        0  r[19..20] = D
  70    Found        2   82   19                                        0  if found goto 82
  71    String8      0    4    0  row                                   0  r[4]='row '
  72    Concat       9    4    4                                        0  r[4]=r[4] + r[9]
  73    String8      0    5    0   missing from index                   0  r[5]=' missing from index '
  74    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  75    String8      0    5    0  idx_t_c                               0  r[5]='idx_t_c'
  76    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  77    Integer      1    3    0                                        0  r[3]=1
  78    ResultRow    4    1    0                                        0  output=r[4]
  79    IfPos        2   81    1                                        0  r[2]>0 -> r[2]-=1, goto 81
  80    Halt         0    0    0                                        0
  81    Goto         0  103    0                                        0
  82    IdxRowId     2   21    0                                        0  r[21]=cursor 2.rowid
  83    Eq          21   20   94                                        0  if r[21]==r[20] goto 94
  84    String8      0    4    0  rowid not at end-of-record for row    0  r[4]='rowid not at end-of-record for row '
  85    Concat       9    4    4                                        0  r[4]=r[4] + r[9]
  86    String8      0    5    0   of index                             0  r[5]=' of index '
  87    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  88    String8      0    5    0  idx_t_c                               0  r[5]='idx_t_c'
  89    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
  90    Integer      1    3    0                                        0  r[3]=1
  91    ResultRow    4    1    0                                        0  output=r[4]
  92    IfPos        2   94    1                                        0  r[2]>0 -> r[2]-=1, goto 94
  93    Halt         0    0    0                                        0
  94    IsNull      19  103    0                                        0  if (r[19]==NULL) goto 103
  95    Next         2   97    0                                        0
  96    Goto         0  103    0                                        0
  97    IdxGT        2  103   19                                        0  key=[19..19]
  98    String8      0    4    0  non-unique entry in index idx_t_c     0  r[4]='non-unique entry in index idx_t_c'
  99    Integer      1    3    0                                        0  r[3]=1
 100    ResultRow    4    1    0                                        0  output=r[4]
 101    IfPos        2  103    1                                        0  r[2]>0 -> r[2]-=1, goto 103
 102    Halt         0    0    0                                        0
 103    AddImm       8    1    0                                        0  r[8]=r[8]+1
 104    Column       0    1   22                                        0  r[22]=t.b
 105    RowId        0   23    0                                        0  r[23]=t.rowid
 106    Affinity    22    1    0                                        0  r[22..23] = B
 107    Found        3  119   22                                        0  if found goto 119
 108    String8      0    4    0  row                                   0  r[4]='row '
 109    Concat       9    4    4                                        0  r[4]=r[4] + r[9]
 110    String8      0    5    0   missing from index                   0  r[5]=' missing from index '
 111    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
 112    String8      0    5    0  idx_t_b                               0  r[5]='idx_t_b'
 113    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
 114    Integer      1    3    0                                        0  r[3]=1
 115    ResultRow    4    1    0                                        0  output=r[4]
 116    IfPos        2  118    1                                        0  r[2]>0 -> r[2]-=1, goto 118
 117    Halt         0    0    0                                        0
 118    Goto         0  131    0                                        0
 119    IdxRowId     3   24    0                                        0  r[24]=cursor 3.rowid
 120    Eq          24   23  131                                        0  if r[24]==r[23] goto 131
 121    String8      0    4    0  rowid not at end-of-record for row    0  r[4]='rowid not at end-of-record for row '
 122    Concat       9    4    4                                        0  r[4]=r[4] + r[9]
 123    String8      0    5    0   of index                             0  r[5]=' of index '
 124    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
 125    String8      0    5    0  idx_t_b                               0  r[5]='idx_t_b'
 126    Concat       5    4    4                                        0  r[4]=r[4] + r[5]
 127    Integer      1    3    0                                        0  r[3]=1
 128    ResultRow    4    1    0                                        0  output=r[4]
 129    IfPos        2  131    1                                        0  r[2]>0 -> r[2]-=1, goto 131
 130    Halt         0    0    0                                        0
 131  Next           0   20    0                                        0
 132  Close          1    0    0                                        0
 133  Count          2   25    0                                        0
 134  Eq            25    7  140                                        0  if r[25]==r[7] goto 140
 135  String8        0    4    0  wrong # of entries in index idx_t_c   0  r[4]='wrong # of entries in index idx_t_c'
 136  Integer        1    3    0                                        0  r[3]=1
 137  ResultRow      4    1    0                                        0  output=r[4]
 138  IfPos          2  140    1                                        0  r[2]>0 -> r[2]-=1, goto 140
 139  Halt           0    0    0                                        0
 140  Close          2    0    0                                        0
 141  Count          3   26    0                                        0
 142  Eq            26    8  148                                        0  if r[26]==r[8] goto 148
 143  String8        0    4    0  wrong # of entries in index idx_t_b   0  r[4]='wrong # of entries in index idx_t_b'
 144  Integer        1    3    0                                        0  r[3]=1
 145  ResultRow      4    1    0                                        0  output=r[4]
 146  IfPos          2  148    1                                        0  r[2]>0 -> r[2]-=1, goto 148
 147  Halt           0    0    0                                        0
 148  Close          3    0    0                                        0
 149  Close          0    0    0                                        0
 150  OpenRead       4    1    0  k(6,B,B,B,B,B)                        0  table=sqlite_schema, root=1, iDb=0
 151  Integer        0   27    0                                        0  r[27]=0
 152  Rewind         4  155    0                                        0  Rewind table sqlite_schema
 153    AddImm      27    1    0                                        0  r[27]=r[27]+1
 154  Next           4  153    0                                        0
 155  Close          4    0    0                                        0
 156  If             3  159    0                                        0  if r[3] goto 159
 157  String8        0    4    0  ok                                    0  r[4]='ok'
 158  ResultRow      4    1    0                                        0  output=r[4]
 159  Halt           0    0    0                                        0
 160  Transaction    0    1    4                                        0  iDb=0 tx_mode=Read
 161  Integer        0   13    0                                        0  r[13]=0
 162  Goto           0    1    0                                        0
