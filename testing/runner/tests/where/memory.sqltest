@database :memory:

# in WHERE clauses, column aliases do not take precedence when resolving identifiers to columns.
@cross-check-integrity
test where_alias_precedence {
    CREATE TABLE t(x,y);
    INSERT INTO t VALUES (1,200),(2,100);
    SELECT x AS y, y AS x FROM t WHERE x = 100;
}
expect {
}

# More aliasing tests
@cross-check-integrity
test where_alias_precedence_2 {
    CREATE TABLE t(x,y);
    INSERT INTO t SELECT value, value+100 FROM generate_series(1,3);
    SELECT x AS lol, y AS x FROM t WHERE x = 101;
}
expect {
}

@cross-check-integrity
test where_alias_precedence_3 {
    CREATE TABLE t(x,y);
    INSERT INTO t SELECT value, value+100 FROM generate_series(1,3);
    SELECT x AS lol, y AS lmao FROM t WHERE lmao = 101;
}
expect {
    1|101
}

