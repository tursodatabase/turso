---
source: windows.sqltest
expression: "SELECT\n        emp_id,\n        name,\n        department,\n        salary,\n        dept_avg,\n        salary - dept_avg AS diff_from_avg,\n        ROW_NUMBER() OVER (ORDER BY salary - dept_avg DESC) AS rank_by_diff\n    FROM (\n        SELECT\n            emp_id,\n            name,\n            department,\n            salary,\n            AVG(salary) OVER (PARTITION BY department) AS dept_avg\n        FROM employees\n    );"
info:
  statement_type: SELECT
  tables:
    - employees
  setup_blocks:
    - schema
  database: ":memory:"
---
QUERY PLAN


BYTECODE
