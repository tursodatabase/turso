---
source: windows.sqltest
expression: "SELECT\n        e.emp_id,\n        e.name,\n        e.department,\n        e.salary,\n        s.amount,\n        s.region,\n        ROW_NUMBER() OVER (PARTITION BY e.department ORDER BY e.salary DESC) AS dept_rank,\n        ROW_NUMBER() OVER (PARTITION BY s.region ORDER BY s.amount DESC) AS region_rank,\n        SUM(s.amount) OVER (PARTITION BY e.department) AS dept_total_sales,\n        AVG(e.salary) OVER (PARTITION BY s.region) AS region_avg_salary\n    FROM employees e\n    JOIN sales s ON e.emp_id = s.emp_id;"
info:
  statement_type: SELECT
  tables:
    - e.emp_id
    - employees
    - sales
  setup_blocks:
    - schema
  database: ":memory:"
---
QUERY PLAN


BYTECODE
