---
source: windows.sqltest
expression: "SELECT\n        sale_id,\n        sale_date,\n        amount,\n        LAG(amount, 1, 0) OVER (ORDER BY sale_date) AS prev_amount,\n        LEAD(amount, 1, 0) OVER (ORDER BY sale_date) AS next_amount,\n        amount - LAG(amount, 1, 0) OVER (ORDER BY sale_date) AS change_from_prev\n    FROM sales;"
info:
  statement_type: SELECT
  tables:
    - sales
  setup_blocks:
    - schema
  database: ":memory:"
---
QUERY PLAN


BYTECODE
