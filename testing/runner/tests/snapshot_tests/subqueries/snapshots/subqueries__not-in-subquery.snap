---
source: subqueries.sqltest
expression: |-
  SELECT id, name, department
      FROM employees
      WHERE id NOT IN (
          SELECT DISTINCT manager_id
          FROM employees
          WHERE manager_id IS NOT NULL
      );
info:
  statement_type: SELECT
  tables:
  - employees
  setup_blocks:
  - schema
  database: ':memory:'
---
QUERY PLAN
|--SCAN employees USING COVERING INDEX idx_employees_manager
`--SCAN employees

BYTECODE
addr  opcode                  p1  p2  p3  p4              p5  comment
   0  Init                     0  37   0                   0  Start at 37
   1  Once                    13   0   0                   0  goto 13
   2  OpenEphemeral            0   0   0                   0  cursor=0 is_table=false
   3  HashClear       1073741824   0   0                   0
   4  OpenRead                 1  12   0  k(2,B)           0  index=idx_employees_manager, root=12, iDb=0
   5  Rewind                   1  13   0                   0  Rewind index idx_employees_manager
   6    Column                 1   0   2                   0  r[2]=idx_employees_manager.manager_id
   7    IsNull                 2  12   0                   0  if (r[2]==NULL) goto 12
   8    Column                 1   0   1                   0  r[1]=idx_employees_manager.manager_id
   9    HashDistinct  1073741824   1   1  jmp=12           0
  10    MakeRecord             1   1   3                   0  r[3]=mkrec(r[1..1]); for ephemeral_index_where_sub_t2
  11    IdxInsert              0   3   0                   8  key=r[3]
  12  Next                     1   6   0                   0
  13  OpenRead                 2   7   0  k(5,B,B,B,B,B)   0  table=employees, root=7, iDb=0
  14  Rewind                   2  36   0                   0  Rewind table employees
  15    Integer                0   7   0                   0  r[7]=0
  16    RowId                  2   8   0                   0  r[8]=employees.rowid
  17    Affinity               8   1   0                   0  r[8..9] = C
  18    Found                  0  27   8                   0  if found goto 27
  19    Rewind                 0  25   0                   0  Rewind  ephemeral_index_where_sub_t2
  20      Column               0   0   9                   0  r[9]=ephemeral_index_where_sub_t2.manager_id
  21      Ne                   8   9  23  Binary           0  if r[8]!=r[9] goto 23
  22      Goto                 0  29   0                   0
  23    Next                   0  20   0                   0
  24    Goto                   0  25   0                   0
  25    Integer                1   7   0                   0  r[7]=1
  26    Goto                   0  30   0                   0
  27    Integer                0   7   0                   0  r[7]=0
  28    Goto                   0  30   0                   0
  29    Null                   0   7   0                   0  r[7]=NULL
  30    IfNot                  7  35   1                   0  if !r[7] goto 35
  31    RowId                  2   4   0                   0  r[4]=employees.rowid
  32    Column                 2   1   5                   0  r[5]=employees.name
  33    Column                 2   3   6                   0  r[6]=employees.department
  34    ResultRow              4   3   0                   0  output=r[4..6]
  35  Next                     2  15   0                   0
  36  Halt                     0   0   0                   0
  37  Transaction              0   1  11                   0  iDb=0 tx_mode=Read
  38  Goto                     0   1   0                   0
