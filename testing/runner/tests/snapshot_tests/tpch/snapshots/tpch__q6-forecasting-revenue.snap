---
source: tpch.sqltest
expression: |-
  select
          sum(l_extendedprice * l_discount) as revenue
      from
          lineitem
      where
          l_shipdate >= '1994-01-01'
          and l_shipdate < '1995-01-01'
          and l_discount between 0.08 - 0.01 and 0.08 + 0.01
          and l_quantity < 24;
info:
  statement_type: SELECT
  tables:
  - lineitem
  setup_blocks:
  - schema
  database: ':memory:'
---
QUERY PLAN
`--SCAN lineitem

BYTECODE
addr  opcode       p1  p2  p3  p4                                     p5  comment
   0  Init          0  23   0                                          0  Start at 23
   1  Null          0   2   0                                          0  r[2]=NULL
   2  OpenRead      0  10   0  k(17,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B)   0  table=lineitem, root=10, iDb=0
   3  Rewind        0  19   0                                          0  Rewind table lineitem
   4    Column      0  10   4                                          0  r[4]=lineitem.l_shipdate
   5    Lt          4   5  18  Binary                                  0  if r[4]<r[5] goto 18
   6    Column      0  10   7                                          0  r[7]=lineitem.l_shipdate
   7    Ge          7   8  18  Binary                                  0  if r[7]>=r[8] goto 18
   8    Column      0   6  11                                          0  r[11]=lineitem.l_discount
   9    Gt         10  11  18  Binary                                  0  if r[10]>r[11] goto 18
  10    Column      0   6  15                                          0  r[15]=lineitem.l_discount
  11    Gt         15  16  18  Binary                                  0  if r[15]>r[16] goto 18
  12    Column      0   4  20                                          0  r[20]=lineitem.l_quantity
  13    Ge         20  21  18  Binary                                  0  if r[20]>=r[21] goto 18
  14    Column      0   5  23                                          0  r[23]=lineitem.l_extendedprice
  15    Column      0   6  24                                          0  r[24]=lineitem.l_discount
  16    Multiply   23  24  22                                          0  r[22]=r[23]*r[24]
  17    AggStep     0  22   2  sum                                     0  accum=r[2] step(r[22])
  18  Next          0   4   0                                          0
  19  AggFinal      0   2   0  sum                                     0  accum=r[2]
  20  Copy          2   1   0                                          0  r[1]=r[2]
  21  ResultRow     1   1   0                                          0  output=r[1]
  22  Halt          0   0   0                                          0
  23  Transaction   0   1   8                                          0  iDb=0 tx_mode=Read
  24  String8       0   5   0  1994-01-01                              0  r[5]='1994-01-01'
  25  String8       0   8   0  1995-01-01                              0  r[8]='1995-01-01'
  26  Real          0  12   0  0.08                                    0  r[12]=0.08
  27  Real          0  13   0  0.01                                    0  r[13]=0.01
  28  Subtract     12  13  10                                          0  r[10]=r[12]-r[13]
  29  Real          0  17   0  0.08                                    0  r[17]=0.08
  30  Real          0  18   0  0.01                                    0  r[18]=0.01
  31  Add          17  18  16                                          0  r[16]=r[17]+r[18]
  32  Integer      24  21   0                                          0  r[21]=24
  33  Goto          0   1   0                                          0
