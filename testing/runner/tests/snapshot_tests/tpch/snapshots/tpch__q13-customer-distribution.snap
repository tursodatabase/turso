---
source: tpch.sqltest
expression: |-
  select
          c_count,
          count(*) as custdist
      from
          (
              select
                  c_custkey,
                  count(o_orderkey) as c_count
              from
                  customer left outer join orders on
                      c_custkey = o_custkey
                      and o_comment not like '%express%packages%'
              group by
                  c_custkey
          ) as c_orders
      group by
          c_count
      order by
          custdist desc,
          c_count desc;
info:
  statement_type: SELECT
  tables:
  - c_custkey
  - customer
  - orders
  setup_blocks:
  - schema
  database: ':memory:'
---
QUERY PLAN
|--SCAN c_orders
|  |--SCAN customer
|  `--HASH JOIN orders
`--USE TEMP B-TREE FOR ORDER BY

