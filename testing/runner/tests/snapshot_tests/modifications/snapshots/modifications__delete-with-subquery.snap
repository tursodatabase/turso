---
source: modifications.sqltest
expression: |-
  DELETE FROM orders
      WHERE user_id IN (
          SELECT id FROM users WHERE status = 'inactive'
      );
info:
  statement_type: DELETE
  tables:
  - orders
  - users
  setup_blocks:
  - schema
  database: ':memory:'
---
QUERY PLAN
`--SCAN users

BYTECODE
addr  opcode          p1  p2  p3  p4            p5  comment
   0  Init             0  43   0                 0  Start at 43
   1  Once            11   0   0                 0  goto 11
   2  OpenEphemeral    0   0   0                 0  cursor=0 is_table=false
   3  OpenRead         1   3   0  k(4,B,B,B,B)   0  table=users, root=3, iDb=0
   4  Rewind           1  11   0                 0  Rewind table users
   5    Column         1   3   3  active         0  r[3]=users.status
   6    Ne             3   4  10  Binary         0  if r[3]!=r[4] goto 10
   7    RowId          1   1   0                 0  r[1]=users.rowid
   8    MakeRecord     1   1   5                 0  r[5]=mkrec(r[1..1]); for ephemeral_index_where_sub_t2
   9    IdxInsert      0   5   0                 8  key=r[5]
  10  Next             1   5   0                 0
  11  OpenWrite        2   5   0                 0  root=5; iDb=0
  12  OpenWrite        3  12   0                 0  root=12; iDb=0
  13  OpenWrite        4  13   0                 0  root=13; iDb=0
  14  Rewind           3  42   0                 0  Rewind index idx_orders_user_id
  15    DeferredSeek   3   2   0                 0
  16    Integer        0   6   0                 0  r[6]=0
  17    Column         3   0   7                 0  r[7]=idx_orders_user_id.user_id
  18    Affinity       7   1   0                 0  r[7..8] = C
  19    NotFound       0  21   7                 0  if not found goto 21
  20    Goto           0  27   0                 0
  21    Rewind         0  29   0                 0  Rewind  ephemeral_index_where_sub_t2
  22      Column       0   0   8                 0  r[8]=ephemeral_index_where_sub_t2.id
  23      Ne           7   8  25  Binary         0  if r[7]!=r[8] goto 25
  24      Goto         0  31   0                 0
  25    Next           0  22   0                 0
  26    Goto           0  29   0                 0
  27    Integer        1   6   0                 0  r[6]=1
  28    Goto           0  32   0                 0
  29    Integer        0   6   0                 0  r[6]=0
  30    Goto           0  32   0                 0
  31    Null           0   6   0                 0  r[6]=NULL
  32    IfNot          6  41   1                 0  if !r[6] goto 41
  33    RowId          2   9   0                 0  r[9]=orders.rowid
  34    Column         2   1  10                 0  r[10]=orders.user_id
  35    RowId          2  11   0                 0  r[11]=orders.rowid
  36    Column         2   2  12                 0  r[12]=orders.product_id
  37    RowId          2  13   0                 0  r[13]=orders.rowid
  38    IdxDelete      4  12   2                 1
  39    Delete         2   0   0  orders         0
  40    IdxDelete      3  10   2                 1
  41  Next             3  15   0                 0
  42  Halt             0   0   0                 0
  43  Transaction      0   2  10                 0  iDb=0 tx_mode=Write
  44  String8          0   4   0  inactive       0  r[4]='inactive'
  45  Goto             0   1   0                 0
