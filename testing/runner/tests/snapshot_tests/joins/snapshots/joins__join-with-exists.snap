---
source: joins.sqltest
expression: |-
  SELECT
          c.customer_id,
          c.name,
          c.city
      FROM
          customers c
      WHERE
          EXISTS (
              SELECT 1
              FROM orders o
              WHERE o.customer_id = c.customer_id
              AND o.total_amount > 1000
          );
info:
  statement_type: SELECT
  tables:
  - customers
  - orders
  setup_blocks:
  - schema
  database: ':memory:'
---
QUERY PLAN
|--SCAN customers AS c
`--SEARCH o USING INDEX idx_orders_customer_id

BYTECODE
addr  opcode                p1  p2  p3  p4              p5  comment
   0    Init                 0  26   0                   0  Start at 26
   1    OpenRead             0   2   0  k(5,B,B,B,B,B)   0  table=customers, root=2, iDb=0
   2    Rewind               0  25   0                   0  Rewind table customers
   3      BeginSubrtn        5   0   0                   0  r[5]=NULL
   4      Integer            0   1   0                   0  r[1]=0
   5      Integer            1   7   0                   0  r[7]=1; LIMIT counter
   6      IfNot              7  18   0                   0  if !r[7] goto 18
   7      OpenRead           1   4   0  k(5,B,B,B,B,B)   0  table=orders, root=4, iDb=0
   8      OpenRead           2   8   0  k(2,B)           0  index=idx_orders_customer_id, root=8, iDb=0
   9      RowId              0   8   0                   0  r[8]=customers.rowid
  10      SeekGE             2  18   8                   0  key=[8..8]
  11        IdxGT            2  18   8                   0  key=[8..8]
  12        DeferredSeek     2   1   0                   0
  13        Column           1   4  10                   0  r[10]=orders.total_amount
  14        Le              10  11  17  Binary           0  if r[10]<=r[11] goto 17
  15        Integer          1   1   0                   0  r[1]=1
  16        DecrJumpZero     7  18   0                   0  if (--r[7]==0) goto 18
  17      Next               2  11   0                   0
  18    Return               5   0   1                   0
  19    IfNot                1  24   1                   0  if !r[1] goto 24
  20    RowId                0   2   0                   0  r[2]=customers.rowid
  21    Column               0   1   3                   0  r[3]=customers.name
  22    Column               0   3   4                   0  r[4]=customers.city
  23    ResultRow            2   3   0                   0  output=r[2..4]
  24  Next                   0   3   0                   0
  25  Halt                   0   0   0                   0
  26  Transaction            0   1  10                   0  iDb=0 tx_mode=Read
  27  Integer             1000  11   0                   0  r[11]=1000
  28  Goto                   0   1   0                   0
