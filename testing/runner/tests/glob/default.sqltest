@database :default:
@database :default-no-rowidalias:

test glob-fn {
    select name, glob('sweat*', name) from products;
}
expect {
    hat|0
    cap|0
    shirt|0
    sweater|1
    sweatshirt|1
    shorts|0
    jeans|0
    sneakers|0
    boots|0
    coat|0
    accessories|0
}

test where-glob {
    select * from products where name glob 'sweat*';
}
expect {
    4|sweater|68.9227440029754
    5|sweatshirt|23.8100541984648
}

test where-glob-question-mark {
    select * from products where name glob 'sweat?r';
}
expect {
    4|sweater|68.9227440029754
}

test where-glob-fn {
    select * from products where glob('sweat*', name)=1
}
expect {
    4|sweater|68.9227440029754
    5|sweatshirt|23.8100541984648
}

test where-not-glob-and {
    select * from products where name not glob 'sweat*' and price >= 70.0;
}
expect {
    1|hat|82.9389679823547
}

test where-glob-or {
    select * from products where name glob 'sweat*' or price >= 80.0;
}
expect {
    1|hat|82.9389679823547
    4|sweater|68.9227440029754
    5|sweatshirt|23.8100541984648
}

test where-glob-another-column {
    select first_name, last_name from users where last_name glob first_name;
}
expect {
    Brown|Brown
    Walter|Walter
    Fay|Fay
}

test where-glob-another-column-prefix {
    select first_name, last_name from users where last_name glob concat(first_name, '*');
}
expect {
    Brown|Brown
    Walter|Walter
    Bo|Bode
    Fay|Fay
}

test where-glob-impossible {
    select * from products where 'foobar' glob 'fooba';
}
expect {
}
