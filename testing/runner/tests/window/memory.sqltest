@database :memory:

test window-partition-by-duplicate-columns {
    CREATE TABLE t1 (a INTEGER, b INTEGER, c INTEGER);
    INSERT INTO t1 VALUES (1, 2, 3);
    SELECT avg(a) OVER (PARTITION BY b, b, c, c, a ORDER BY c) FROM t1;
}
expect {
    1.0
}
expect @js {
    1
}

test window-collate-partition-by {
    CREATE TABLE fruits(name collate nocase);
    INSERT INTO fruits(name) VALUES ('Apple'), ('banana'), ('apple');
    SELECT
    name,
    count(*) OVER (PARTITION BY name)
    FROM fruits;
}
expect {
    Apple|2
    apple|2
    banana|1
}

test window-collate-order-by {
    CREATE TABLE fruits(name collate nocase);
    INSERT INTO fruits(name) VALUES ('Apple'),('banana'), ('apple');
    SELECT
    name,
    count(*) OVER (ORDER BY name)
    FROM fruits;
}
expect {
    Apple|2
    apple|2
    banana|3
}

