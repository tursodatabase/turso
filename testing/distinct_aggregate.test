# Test for SELECT DISTINCT with aggregates
# Issue #4512: Corrupt database: Reference to undefined or unresolved label

statement ok
CREATE TABLE t0 (c0 REAL);

statement ok
CREATE TABLE t1 (c0 INT);

statement ok
INSERT INTO t0 VALUES (1.0), (2.0);

statement ok
INSERT INTO t1 VALUES (1), (2);

# This should not error with "Reference to undefined or unresolved label"
query I
SELECT DISTINCT COUNT(t0.c0) FROM t0, t1;
----
4

# Additional test cases for SELECT DISTINCT with aggregates
query I
SELECT DISTINCT SUM(t0.c0) FROM t0, t1;
----
6

query I
SELECT DISTINCT MAX(t0.c0) FROM t0, t1;
----
2

query I
SELECT DISTINCT MIN(t0.c0) FROM t0, t1;
----
1

# Test with single table
query I
SELECT DISTINCT COUNT(c0) FROM t0;
----
2
